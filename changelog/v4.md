# v4 — Multi-level dungeon (ADOM-style)

**Issue:** [#1 3d?](https://github.com/ForkArcade/engine-test/issues/1)
**Category:** feature

## Changes

- Replaced random wall scatter with room-based procedural generation (random room placement + L-shaped corridors)
- 5 dungeon floors connected by stairs (down `>` orange, up `<` cyan)
- Walking onto stairs auto-transitions between floors
- Each floor is persistent — enemies and items preserved when revisiting
- Enemies scale per depth: more rats, higher HP/ATK/DEF on deeper floors
- Items scale per depth: more gold (higher value), more potions
- Victory requires clearing all enemies on all 5 floors
- Score includes depth bonus (500 per floor reached beyond first)
- Depth indicator shown in UI panel
- Game over screen shows deepest floor reached
- New narrative nodes: "descent" (first time going deeper), "deep_dungeon" (floors 4+)
- Reverted v3 raycasting — kept top-down 2D view as intended

## Reasoning

The issue asked for "3D" which means multi-level dungeon depth (like ADOM), not a first-person camera. Room-based generation with corridors creates proper dungeon layouts instead of random wall scatter. Floor persistence means tactical decisions (leave potions for later, retreat upstairs). Enemy/item scaling per depth creates natural difficulty progression. Victory requiring all floors cleared gives the game a real goal.

## Files modified

- `data.js` — maxDepth, room generation config, stairs colors, depthBonus scoring, descent/deep_dungeon narrative nodes
- `game.js` — room-based map generation, floor storage/transitions, stairs mechanics, enemy/item scaling per depth, allFloorsCleared victory condition
- `render.js` — stairs tile rendering with `>` / `<` symbols, depth indicator in UI, deepest floor in game over stats
